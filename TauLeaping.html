

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tau-Leaping &mdash; Compartmental Modeling (CMS)  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/tipuesearch/tipuesearch.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Compartmental Modeling (CMS)  documentation" href="index.html"/>
        <link rel="up" title="Solvers" href="solvers.html"/>
        <link rel="next" title="BLeaping" href="BLeaping.html"/>
        <link rel="prev" title="Midpoint Tau-Leaping" href="Midpoint.html"/>

<link href="https://fonts.googleapis.com/css?family=Lato|Montserrat|Open+Sans" rel="stylesheet">



  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Compartmental Modeling (CMS)
          

          
            
            <img src="_static/IDM_white.png" class="logo" />
          
          </a>

          
            
            
          

          <div role="search">
  <form id='rtd-search-form' class='wy-form' action="search-local.html" method="get">
    <input type="text" name="q" id="tipue_search_input" autocomplete="off"
           placeholder="Search docs" required>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cms-installation.html">CMS installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="introduction-software.html">Introduction to the software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="emodl.html">EMODL – model language for an input model file</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-file.html">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="random-number-library.html">Random number library</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="solvers.html">Solvers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Gillespie.html">Gillespie</a></li>
<li class="toctree-l3"><a class="reference internal" href="GillespieFirstReaction.html">GillespieFirstReaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="GibsonBruck.html">Gibson-Bruck Next Reaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="ExitTimes.html">ExitTimes</a></li>
<li class="toctree-l3"><a class="reference internal" href="Hybrid.html">Hybrid SSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="Midpoint.html">Midpoint Tau-Leaping</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Tau-Leaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="BLeaping.html">BLeaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="RLeaping.html">RLeaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="RLeapingFast.html">RLeapingFast</a></li>
<li class="toctree-l3"><a class="reference internal" href="TransportSSA.html">TransportSSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="OptimalTransportSSA.html">OptimalTransportSSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="DFSP.html">DFSP</a></li>
<li class="toctree-l3"><a class="reference internal" href="FractionalDiffusion.html">FractionalDiffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="dwSSA.html">dwSSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdwSSA.html">sdwSSA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output-files.html">Output files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction-modeling.html">Introduction to compartmental modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto-software.html">How to use the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Compartmental Modeling (CMS)</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="introduction-software.html">Introduction to the software</a> &raquo;</li>
        
          <li><a href="solvers.html">Solvers</a> &raquo;</li>
        
      <li>Tau-Leaping</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<!-- From _templates/page.html -->

  <div class="section" id="tau-leaping">
<h1>Tau-Leaping<a class="headerlink" href="#tau-leaping" title="Permalink to this headline">¶</a></h1>
<p>Tau-Leaping is a stochastic simulation algorithm (SSA) developed by Gillespie to increase the computational speed of the exact SSAs <a class="footnote-reference" href="#id4" id="id1">[1]</a>.  Instead of computing the time to every reaction, this algorithm approximates the process and attempts to leap in time, executing a large number of reactions in a period tau.  This algorithm is computationally faster, however, the approximation removes the “exact” connection to the solution of the master equation for the system.</p>
<p>The implementation of tau-leaping in this framework is based on a recent work by Cao et. al <a class="footnote-reference" href="#id5" id="id2">[2]</a>.  This modified tau-leaping algorithm helps avoid the possibility of creating negative species counts within a compartment.</p>
<p><strong>.json file template</strong></p>
<div class="highlight-JSON"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;duration&quot;</span> <span class="p">:</span> <span class="mi">365</span><span class="p">,</span>
    <span class="nt">&quot;runs&quot;</span>   <span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
    <span class="nt">&quot;solver&quot;</span> <span class="p">:</span> <span class="s2">&quot;TAULEAPING&quot;</span><span class="p">,</span>
    <span class="nt">&quot;tau-leaping&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;epsilon&quot;</span> <span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
        <span class="nt">&quot;nc&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="nt">&quot;multiple&quot;</span> <span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
        <span class="nt">&quot;SSAruns&quot;</span> <span class="p">:</span> <span class="mi">100</span>
    <span class="p">}</span> 
<span class="p">}</span> 
</pre></div>
</div>
<p><strong>.json syntax for Tau-leaping</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">solver</span></code></dt>
<dd>takes a string as an input. <code class="code docutils literal"><span class="pre">TAU</span></code> and <code class="code docutils literal"><span class="pre">TAULEAPING</span></code> ARE the only valid names to run this solver.</dd>
<dt><code class="docutils literal"><span class="pre">epsilon</span></code></dt>
<dd>takes a float as an input.  The parameter <code class="code docutils literal"><span class="pre">epsilon</span></code> is used to compute the largest time step tau that is not likely to result in propensity function changes by more than epsilon multiplied by the sum of all the propensities.  For larger values of tau, the step sizes will also be larger.  If the <code class="code docutils literal"><span class="pre">epsilon</span></code> field is missing in the .json file, then the tau-leaping solver will set the value to 0.001.</dd>
<dt><code class="docutils literal"><span class="pre">nc</span></code></dt>
<dd>takes an integer as an input. The parameter <code class="code docutils literal"><span class="pre">nc</span></code> is used as a threshold to separate critical and noncritical reactions.  A critical reaction is defined as a reaction that is at risk for driving the count of a species below zero.  If <code class="code docutils literal"><span class="pre">nc</span></code> is chosen to be extremely large, then all reactions become critical.  This case would reduce to the exact SSA.  Alternatively, if <code class="code docutils literal"><span class="pre">nc</span></code> is chosen to be zero, then there will not be any noncritical reactions.  The case reduces to the original tauleaping algorithm in <a class="footnote-reference" href="#id4" id="id3">[1]</a>.  If the <code class="code docutils literal"><span class="pre">nc</span></code> field is missing in the .json file, then the tauleaping solver will set the value to 2.</dd>
<dt><code class="docutils literal"><span class="pre">multiple</span></code></dt>
<dd>takes an integer as an input.  The parameter <code class="code docutils literal"><span class="pre">multiple</span></code> is used as a threshold to decide on whether to execute a series of SSA steps instead of a tauleap.  If a leap value of tau is chosen (from the noncritical reaction rates) such that it is less than the <code class="code docutils literal"><span class="pre">multiple</span></code> times 1 over the total propensity rate, than the SSA steps are performed.  If the <code class="code docutils literal"><span class="pre">multiple</span></code> field is missing in the .json file, then the tauleaping solver will set the value to 10.</dd>
<dt><code class="docutils literal"><span class="pre">SSAruns</span></code></dt>
<dd>takes an integer as an input. It defines the number of SSA runs that are performed when the proposed leap size from the noncritical reactions is less than <code class="code docutils literal"><span class="pre">multiple</span></code> times 1 over the total propensity rate.  If the <code class="code docutils literal"><span class="pre">SSAruns</span></code> field is missing in the .json file, then the tau-leaping solver will set the value to 100.</dd>
</dl>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id3">2</a>)</em> <a class="reference external" href="http://dx.doi.org/10.1063/1.1378322">Gillespie, D T. et al. “Approximate accelerated stochastic simulation of chemically reacting systems.” The Journal of Chemical Physics 115 4 (2001): 1716.</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://dx.doi.org/10.1063/1.1992473">Cao, Y. et al. “Avoiding negative populations in explicit Poisson tau-leaping.” The Journal of Chemical Physics 123 (2005): 054104.</a></td></tr>
</tbody>
</table>
</div>


<div id="tipue_search_content"></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="BLeaping.html" class="btn btn-neutral float-right" title="BLeaping" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Midpoint.html" class="btn btn-neutral" title="Midpoint Tau-Leaping" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Intellectual Ventures Management, LLC (IVM). All rights reserved.

    </p>
  </div>
<p>EMOD is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode">Creative Commons Attribution-Noncommercial-ShareAlike 4.0 License</a>.</p>
<p>Send documentation feedback to <a href="mailto:feedback@idmod.org" target="_top">feedback@idmod.org</a>.</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_content.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_set.js"></script>
      <script type="text/javascript" src="_static/runsearch.js"></script>
      <script type="text/javascript" src="_static/tablecollapse.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>