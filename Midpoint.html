

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Midpoint Tau-Leaping &mdash; Compartmental Modeling (CMS)  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/tipuesearch/tipuesearch.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Compartmental Modeling (CMS)  documentation" href="index.html"/>
        <link rel="up" title="Approximate Methods" href="Approximate Methods.html"/>
        <link rel="next" title="RLeaping" href="RLeaping.html"/>
        <link rel="prev" title="Hybrid SSA" href="Hybrid.html"/>

<link href="https://fonts.googleapis.com/css?family=Lato|Montserrat|Open+Sans" rel="stylesheet">



  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Compartmental Modeling (CMS)
          

          
            
            <img src="_static/IDM_white.png" class="logo" />
          
          </a>

          
            
            
          

          <div role="search">
  <form id='rtd-search-form' class='wy-form' action="search-local.html" method="get">
    <input type="text" name="q" id="tipue_search_input" autocomplete="off"
           placeholder="Search docs" required>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction-modeling.html">Introduction to compartmental modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="cms-installation.html">CMS installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="introduction-software.html">Introduction to the software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="emodl.html">EMODL – model language for an input model file</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-file.html">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="random-number-library.html">Random number library</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="solvers.html">Solvers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Exact Methods.html">Exact Methods</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="Approximate Methods.html">Approximate Methods</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="BLeaping.html">BLeaping</a></li>
<li class="toctree-l4"><a class="reference internal" href="Hybrid.html">Hybrid SSA</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Midpoint Tau-Leaping</a></li>
<li class="toctree-l4"><a class="reference internal" href="RLeaping.html">RLeaping</a></li>
<li class="toctree-l4"><a class="reference internal" href="RLeapingFast.html">RLeapingFast</a></li>
<li class="toctree-l4"><a class="reference internal" href="TauLeaping.html">Tau-Leaping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Spatial Simulation Methods.html">Spatial Simulation Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="Specialty Methods.html">Specialty Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output-files.html">Output files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="howto-software.html">How to use the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Compartmental Modeling (CMS)</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="introduction-software.html">Introduction to the software</a> &raquo;</li>
        
          <li><a href="solvers.html">Solvers</a> &raquo;</li>
        
          <li><a href="Approximate Methods.html">Approximate Methods</a> &raquo;</li>
        
      <li>Midpoint Tau-Leaping</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<!-- From _templates/page.html -->

  <div class="section" id="midpoint-tau-leaping">
<h1>Midpoint Tau-Leaping<a class="headerlink" href="#midpoint-tau-leaping" title="Permalink to this headline">¶</a></h1>
<p>The midpoint tau-Leaping algorithm is a modification of <a class="reference internal" href="TauLeaping.html"><span class="doc">tau-leaping</span></a> <a class="footnote-reference" href="#id3" id="id1">[1]</a>.  Instead of using the current state of the system to evaluate the propensity functions, an estimated midpoint state is constructed.  Then, this midpoint state is used to evaluate the propensity functions from the current time t.  This modification has a direct analogy in the simulation of deterministic systems.</p>
<p><strong>.json file template</strong></p>
<div class="highlight-JSON"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;duration&quot;</span> <span class="p">:</span> <span class="mi">365</span><span class="p">,</span>
    <span class="nt">&quot;runs&quot;</span>   <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="nt">&quot;solver&quot;</span> <span class="p">:</span> <span class="s2">&quot;MidPoint&quot;</span><span class="p">,</span>
    <span class="nt">&quot;midpoint&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;epsilon&quot;</span> <span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
        <span class="nt">&quot;nc&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="nt">&quot;multiple&quot;</span> <span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
        <span class="nt">&quot;SSAruns&quot;</span> <span class="p">:</span> <span class="mi">100</span>
    <span class="p">}</span> 
<span class="p">}</span> 
</pre></div>
</div>
<p><strong>.json syntax for Midpoint Tau-leaping</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">solver</span></code></dt>
<dd>takes a string as an input. <code class="code docutils literal"><span class="pre">Tau</span></code> and <code class="code docutils literal"><span class="pre">TauLeaping</span></code> are both valid names to run this solver.</dd>
<dt><code class="docutils literal"><span class="pre">epsilon</span></code></dt>
<dd>takes a float as an input.  The parameter <code class="code docutils literal"><span class="pre">epsilon</span></code> is used to compute the largest time step tau that is not likely to result in propensity function changes by more than epsilon multiplied by the sum of all the propensities.  For larger values of tau, the step sizes will also be larger.  If the <code class="code docutils literal"><span class="pre">epsilon</span></code> field is missing in the .json file, then a deafult value of 0.01 is used.</dd>
<dt><code class="docutils literal"><span class="pre">nc</span></code></dt>
<dd>takes an integer as an input. The parameter <code class="code docutils literal"><span class="pre">nc</span></code> is used as a threshold to separate critical and noncritical reactions.  A critical reaction is defined as a reaction that is at risk for driving the count of a species below zero.  If <code class="code docutils literal"><span class="pre">nc</span></code> is chosen to be extremely large, then all reactions become critical.  This case would reduce to the exact <a class="reference internal" href="Gillespie.html"><span class="doc">SSA</span></a>.  Alternatively, if <code class="code docutils literal"><span class="pre">nc</span></code> is chosen to be zero, then there will not be any noncritical reactions.  The case reduces to the <a class="reference internal" href="TauLeaping.html"><span class="doc">original tauleaping algorithm</span></a> in <a class="footnote-reference" href="#id3" id="id2">[1]</a>.  If the <code class="code docutils literal"><span class="pre">nc</span></code> field is missing in the .json file, then a default value of 2 is used.</dd>
<dt><code class="docutils literal"><span class="pre">multiple</span></code></dt>
<dd>takes an integer as an input.  The parameter <code class="code docutils literal"><span class="pre">multiple</span></code> is used as a threshold to decide on whether to execute a series of SSA steps instead of a tauleap.  If a leap value of tau is chosen (from the noncritical reaction rates) such that it is less than the <code class="code docutils literal"><span class="pre">multiple</span></code> times 1 over the total propensity rate, than the SSA steps are performed.  If the <code class="code docutils literal"><span class="pre">multiple</span></code> field is missing in the .json file, then a default value of 10 is used.</dd>
<dt><code class="docutils literal"><span class="pre">SSAruns</span></code></dt>
<dd>takes an integer as an input. It defines the number of SSA runs that are performed when the proposed leap size from the noncritical reactions is less than <code class="code docutils literal"><span class="pre">multiple</span></code> times 1 over the total propensity rate.  If the <code class="code docutils literal"><span class="pre">SSAruns</span></code> field is missing in the .json file, then a default value of 100 is used.</dd>
</dl>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> <a class="reference external" href="http://dx.doi.org/10.1063/1.1378322">Gillespie, D. T. et al. “Approximate accelerated stochastic simulation of chemically reacting systems.” The Journal of Chemical Physics 115 4 (2001): 1716.</a></td></tr>
</tbody>
</table>
</div>


<div id="tipue_search_content"></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="RLeaping.html" class="btn btn-neutral float-right" title="RLeaping" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Hybrid.html" class="btn btn-neutral" title="Hybrid SSA" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Intellectual Ventures Management, LLC (IVM). All rights reserved.

    </p>
  </div>
<p>EMOD is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode">Creative Commons Attribution-Noncommercial-ShareAlike 4.0 License</a>.</p>
<p>Send documentation feedback to <a href="mailto:feedback@idmod.org" target="_top">feedback@idmod.org</a>.</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_content.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_set.js"></script>
      <script type="text/javascript" src="_static/runsearch.js"></script>
      <script type="text/javascript" src="_static/tablecollapse.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>